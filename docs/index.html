<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ME 405 Term Project: ME 405 Term Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ME 405 Term Project<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Pressure Sensing Depth Control Chamber</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ME 405 Term Project </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The purpose of this project was to develop a preliminary depth control chamber.</p>
<p>Pressure can be directly correlated to depth, given a liquid's density. This project takes a desired pressure setpoint and controls a motor-driven syringe system to pressurize a chamber to the setpoint. It waits a period of time, as if it were underwater collecting data, and then returns to the initial pressure, as if it were returning to the water surface.</p>
<h1><a class="anchor" id="soft_org_sec"></a>
Software Description and Organization</h1>
<p>The main program uses three classes to do our desired function. It contains multiple tasks in which it multitasks between one another.</p>
<p>Following a brief description of the main program, the classes used are mentioned.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
Main Program</h2>
<p>The main program initially collects a setpoint pressure, which is the desired pressure the user wants to go to. Then, as the program multitasks, is uses the Pressure Sensor class to essentially interpret and collect pressure values. It works with the Closed-Loop Controller class to run the motor driver based on calculated error between setpoint and current pressure. The program with run the controller until reaching the setpoint, in which it turns the motor off for a time duration. Then, the program will use both the Pressure Sensor and Closed-Loop Controller classes again to return the chamber to the initial pressure from start up.</p>
<p>Throughout the duration of the program, if there are pressure values being collected, there will be values printed. This occurs by the program multitasking between data collection and printing.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Pressure Sensor Class</h2>
<p>To measure pressure, we used a Honeywell Board Mount Pressure Sensor, which uses I^2C communication. The sensor transmits data in byte arrays. The first byte being status, next two being pressure, and following two being temperature. A PressureSensor class was created to process the data from bytes into counts and then interpretable values of pressure in [psi] and temperature in [Farenheight].</p>
<p>Two types of data were collected. One being pressure, our primary focus, and the other temperature, for future use. You can read more about our pressure sensor and its I^2C communication using the links included at the bottom of the readme.</p>
<ul>
<li>def <b>init</b>: Initialize the PressureSensor Object. Collect initial data values for status and initial pressure.</li>
<li>def readP_Raw: Reads Raw Status, Pressure, and Temperature Data from Sensor</li>
<li>def PtoRawP: Converts setpoint pressure from units of psi to counts.</li>
<li>def RawtoData_P: Converts raw pressure data in units of counts to [psi]. Then pressure difference from initial pressure and thus displacement depth</li>
<li>def RawtoData_T: Converts raw pressure data in units of counts to [Fahrenheit].</li>
</ul>
<h3><a class="anchor" id="autotoc_md2"></a>
Status</h3>
<p>To interpret the status output from the pressure sensor, the table below was used, provided from the manual, "I^2C Communications with Honeywell Digital Output Pressure".</p>
<p><img src="https://github.com/alialauren1/ME405-Term-Project/assets/157066441/f21555c3-b900-4082-98ba-afea877355a0" alt="Screenshot 2024-03-17 at 9 48 11 PM" width="294" class="inline"/></p>
<p>The class was written to always print the status upon calling it. Throughout our use and application of the class, the status of the sensor was always S1 = 0 and S0 = 0, indicating we were in a normal operation, whilst collecting valid data. <br  />
</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Pressure</h3>
<p>To calculate the pressure from the digital output, the pressure sensor transfer function shown below was used, also provided from the manual, "I^2C Communications with Honeywell Digital Output Pressure". The equation was rearranged to solve for Pressure.</p>
<p><img src="https://github.com/alialauren1/ME405-Term-Project/assets/157066441/e8322335-e550-4d0f-b144-daa90d571818" alt="Screenshot 2024-03-17 at 9 38 54 PM" width="326" class="inline"/></p>
<p>Where,</p>
<p><img src="https://github.com/alialauren1/ME405-Term-Project/assets/157066441/81dee95d-3d2a-44a9-8cc6-a6c065db89b8" alt="Screenshot 2024-03-17 at 9 41 27 PM" width="347" class="inline"/></p>
<h3><a class="anchor" id="autotoc_md4"></a>
Temperature</h3>
<p>The temperature conversion function shown below was also provided in the Honeywell I^2C manual. Although, it was modified to convert the temperature into Fahrenheit.</p>
<p><img src="https://github.com/alialauren1/ME405-Term-Project/assets/157066441/79dcab9f-85fb-4055-beed-cf1e42050b7f" alt="Screenshot 2024-03-17 at 9 46 18 PM" width="249" class="inline"/></p>
<h3><a class="anchor" id="autotoc_md5"></a>
Setpoint Conversion</h3>
<p>A definition in the pressure sensor class was made to convert pressure values in [psi] to counts. This was to aid user input of a setpoint. They may now type a setpoint in [psi] and it gets converted to interpretable data, that being counts, for use in our Closed-Loop Controller Class.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Motor Driver Class</h2>
<p>This class implements a motor driver, setting the duty cycle for the motor. It allows for initialization of the motor pins and timer.</p>
<ul>
<li>def <b>init</b>: Creates a motor driver by initializing GPIO pins and turning off the motor for safety.</li>
<li>def set_duty_cycle: This method sets the duty cycle to be sent to the motor to the given level. Positive values cause torque in one direction, negative values in the opposite direction.</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
Closed-Loop Controller Class</h2>
<p>This class is a closed-loop control system with proportional control.</p>
<ul>
<li>def <b>init</b>: Inits the Controller object with the provided proportional gain and set points.</li>
<li>def run: Runs the controller and calculation for the actual values based by the measured output.</li>
<li>def set_setpoint: Takes in a desired set point. Sets new setpoint for class</li>
<li>def set_Kp: Takes in a desired Kp value. Sets new Kp for class</li>
</ul>
<h1><a class="anchor" id="T_S_sec"></a>
Tasks and States for Main Program</h1>
<p>This section describes the tasks and corresponding states used in our main program. Our main program handles multitasking between different tasks using cotask.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Task Diagram</h2>
<p>Below is the task diagram for our main program. There are two tasks. </p><div class="image">
<img src="ME405_Main_Task_Diagram.png" alt="" width="500px" height="240px"/>
<div class="caption">
ME405 Main Program Task Diagram</div></div>
 <h3><a class="anchor" id="autotoc_md9"></a>
Task 1:</h3>
<ul>
<li>Gets time and pressure out of a queue and the current Task 2 value out of a share.</li>
<li>Converts pressure from units of counts to [psi] and displays value along with corresponding depth underwater in [ft] and time duration. </li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
Task 2:</h3>
<ul>
<li>Converts desired setpoint from units of [psi] to counts using Pressure Sensor Class</li>
<li>Reads pressure sensor data in units of counts from Pressure Sensor Class.</li>
<li>Runs closed-loop controller with pressure counts comparing against setpoint to send motor PWM commands.</li>
<li>Puts time duration and pressure into queue</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Finite State Machines</h2>
<p>Below are the Finite State Machines (FSM) corresponding to the two tasks in our main program. </p><div class="image">
<img src="ME405_FSM_Task_1.png" alt="" width="580px" height="290px"/>
<div class="caption">
ME405 FSM Task 1</div></div>
 <div class="image">
<img src="ME405_FSM_Task_2.png" alt="" width="620px" height="400px"/>
<div class="caption">
ME405 FSM Task 2</div></div>
 </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
